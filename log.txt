00000000  70 61 63 6b 61 67 65 20  6d 61 69 6e 0a 0a 69 6d  |package main..im|
00000010  70 6f 72 74 20 28 0a 09  22 62 75 66 69 6f 22 0a  |port (.."bufio".|
00000020  09 22 65 6e 63 6f 64 69  6e 67 2f 68 65 78 22 0a  |."encoding/hex".|
00000030  09 22 66 6c 61 67 22 0a  09 22 66 6d 74 22 0a 09  |."flag".."fmt"..|
00000040  22 6c 6f 67 22 0a 09 22  6f 73 22 0a 09 22 6f 73  |"log".."os".."os|
00000050  2f 65 78 65 63 22 0a 09  22 72 75 6e 74 69 6d 65  |/exec".."runtime|
00000060  22 0a 09 22 74 69 6d 65  22 0a 29 0a 0a 76 61 72  |".."time".)..var|
00000070  20 28 0a 09 66 6c 61 67  48 65 6c 70 20 3d 20 66  | (..flagHelp = f|
00000080  6c 61 67 2e 42 6f 6f 6c  28 22 68 22 2c 20 66 61  |lag.Bool("h", fa|
00000090  6c 73 65 2c 20 60 50 72  69 6e 74 20 74 68 65 20  |lse, `Print the |
000000a0  68 65 6c 70 20 6d 65 6e  75 20 61 6e 64 20 65 78  |help menu and ex|
000000b0  69 74 60 29 0a 09 66 6c  61 67 46 69 6c 65 20 3d  |it`)..flagFile =|
000000c0  20 66 6c 61 67 2e 53 74  72 69 6e 67 28 22 66 69  | flag.String("fi|
000000d0  6c 65 22 2c 20 22 22 2c  20 60 46 69 6c 65 60 29  |le", "", `File`)|
000000e0  0a 29 0a 0a 66 75 6e 63  20 69 73 66 6c 61 67 67  |.)..func isflagg|
000000f0  65 64 28 29 20 7b 0a 09  66 6c 61 67 2e 50 61 72  |ed() {..flag.Par|
00000100  73 65 28 29 0a 09 2f 2f  0a 09 69 66 20 2a 66 6c  |se()..//..if *fl|
00000110  61 67 48 65 6c 70 20 7b  0a 09 09 66 6d 74 2e 50  |agHelp {...fmt.P|
00000120  72 69 6e 74 6c 6e 28 22  2d 3e 20 55 73 61 67 65  |rintln("-> Usage|
00000130  73 20 7c 20 67 6f 20 72  75 6e 20 6d 61 69 6e 2e  |s | go run main.|
00000140  67 6f 20 2d 66 69 6c 65  20 3c 66 69 6c 65 6e 61  |go -file <filena|
00000150  6d 65 3e 20 2d 62 79 74  65 20 3c 31 2d 31 30 30  |me> -byte <1-100|
00000160  30 3e 20 22 29 0a 09 09  6f 73 2e 45 78 69 74 28  |0> ")...os.Exit(|
00000170  31 29 0a 09 7d 0a 09 2f  2f 0a 7d 0a 0a 66 75 6e  |1)..}..//.}..fun|
00000180  63 20 65 28 65 72 72 20  65 72 72 6f 72 29 20 7b  |c e(err error) {|
00000190  0a 09 69 66 20 65 72 72  20 21 3d 20 6e 69 6c 20  |..if err != nil |
000001a0  7b 0a 09 09 6c 6f 67 2e  46 61 74 61 6c 28 65 72  |{...log.Fatal(er|
000001b0  72 29 0a 09 7d 0a 7d 0a  0a 66 75 6e 63 20 62 61  |r)..}.}..func ba|
000001c0  6e 6e 65 72 28 29 20 7b  0a 09 63 6f 6e 74 65 6e  |nner() {..conten|
000001d0  74 2c 20 65 72 72 20 3a  3d 20 6f 73 2e 52 65 61  |t, err := os.Rea|
000001e0  64 46 69 6c 65 28 22 62  61 6e 6e 65 72 2e 74 78  |dFile("banner.tx|
000001f0  74 22 29 0a 09 65 28 65  72 72 29 0a 09 66 6d 74  |t")..e(err)..fmt|
00000200  2e 50 72 69 6e 74 6c 6e  28 22 5c 30 33 33 5b 33  |.Println("\033[3|
00000210  35 6d 22 2c 20 73 74 72  69 6e 67 28 63 6f 6e 74  |5m", string(cont|
00000220  65 6e 74 29 29 0a 7d 0a  0a 66 75 6e 63 20 63 6c  |ent)).}..func cl|
00000230  65 61 72 28 29 20 7b 0a  09 69 66 20 72 75 6e 74  |ear() {..if runt|
00000240  69 6d 65 2e 47 4f 4f 53  20 3d 3d 20 22 77 69 6e  |ime.GOOS == "win|
00000250  64 6f 77 73 22 20 7b 0a  09 09 63 6c 73 2c 20 65  |dows" {...cls, e|
00000260  72 72 20 3a 3d 20 65 78  65 63 2e 43 6f 6d 6d 61  |rr := exec.Comma|
00000270  6e 64 28 22 63 6c 73 22  29 2e 4f 75 74 70 75 74  |nd("cls").Output|
00000280  28 29 0a 09 09 69 66 20  65 72 72 20 21 3d 20 6e  |()...if err != n|
00000290  69 6c 20 7b 0a 09 09 09  6c 6f 67 2e 46 61 74 61  |il {....log.Fata|
000002a0  6c 28 65 72 72 29 0a 09  09 7d 0a 09 09 6f 75 74  |l(err)...}...out|
000002b0  70 75 74 20 3a 3d 20 73  74 72 69 6e 67 28 63 6c  |put := string(cl|
000002c0  73 5b 3a 5d 29 0a 09 09  66 6d 74 2e 50 72 69 6e  |s[:])...fmt.Prin|
000002d0  74 6c 6e 28 6f 75 74 70  75 74 29 0a 09 7d 0a 09  |tln(output)..}..|
000002e0  69 66 20 72 75 6e 74 69  6d 65 2e 47 4f 4f 53 20  |if runtime.GOOS |
000002f0  3d 3d 20 22 6c 69 6e 75  78 22 20 7b 0a 09 09 63  |== "linux" {...c|
00000300  6c 65 61 72 2c 20 65 72  72 20 3a 3d 20 65 78 65  |lear, err := exe|
00000310  63 2e 43 6f 6d 6d 61 6e  64 28 22 63 6c 65 61 72  |c.Command("clear|
00000320  22 29 2e 4f 75 74 70 75  74 28 29 0a 09 09 65 28  |").Output()...e(|
00000330  65 72 72 29 0a 09 09 6f  75 74 70 75 74 20 3a 3d  |err)...output :=|
00000340  20 73 74 72 69 6e 67 28  63 6c 65 61 72 5b 3a 5d  | string(clear[:]|
00000350  29 0a 09 09 66 6d 74 2e  50 72 69 6e 74 6c 6e 28  |)...fmt.Println(|
00000360  6f 75 74 70 75 74 29 0a  09 7d 0a 7d 0a 0a 66 75  |output)..}.}..fu|
00000370  6e 63 20 6d 61 69 6e 28  29 20 7b 0a 09 63 6c 65  |nc main() {..cle|
00000380  61 72 28 29 0a 09 62 61  6e 6e 65 72 28 29 0a 09  |ar()..banner()..|
00000390  66 6c 61 67 2e 50 61 72  73 65 28 29 0a 09 69 73  |flag.Parse()..is|
000003a0  66 6c 61 67 67 65 64 28  29 0a 09 72 2c 20 65 72  |flagged()..r, er|
000003b0  72 20 3a 3d 20 6f 73 2e  53 74 61 74 28 2a 66 6c  |r := os.Stat(*fl|
000003c0  61 67 46 69 6c 65 29 0a  09 65 28 65 72 72 29 0a  |agFile)..e(err).|
000003d0  09 72 65 20 3a 3d 20 72  2e 53 69 7a 65 28 29 0a  |.re := r.Size().|
000003e0  09 66 6d 74 2e 50 72 69  6e 74 6c 6e 28 22 2d 2d  |.fmt.Println("--|
000003f0  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000400  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000410  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 2d 2d 2d 2d 2d  |----------------|
00000420  2d 2d 2d 2d 2d 2d 2d 2d  2d 2d 2d 22 29 0a 09 66  |-----------")..f|
00000430  6d 74 2e 50 72 69 6e 74  6c 6e 28 22 5c 30 33 33  |mt.Println("\033|
00000440  5b 33 34 6d 5b 20 2b 20  5d 20 46 69 6c 65 20 42  |[34m[ + ] File B|
00000450  65 69 6e 67 20 52 65 61  64 20 7e 3e 20 22 2c 20  |eing Read ~> ", |
00000460  2a 66 6c 61 67 46 69 6c  65 29 0a 09 66 6d 74 2e  |*flagFile)..fmt.|
00000470  50 72 69 6e 74 6c 6e 28  22 5c 30 33 33 5b 33 34  |Println("\033[34|
00000480  6d 5b 20 2b 20 5d 20 46  69 6c 65 20 42 79 74 65  |m[ + ] File Byte|
00000490  20 53 69 7a 65 20 20 7e  3e 20 22 2c 20 72 65 29  | Size  ~> ", re)|
000004a0  0a 09 66 6d 74 2e 50 72  69 6e 74 6c 6e 28 22 5c  |..fmt.Println("\|
000004b0  30 33 33 5b 33 33 6d 5b  20 2a 20 5d 20 57 41 52  |033[33m[ * ] WAR|
000004c0  4e 3a 20 54 6f 20 70 72  65 76 65 6e 74 20 73 74  |N: To prevent st|
000004d0  61 63 6b 2f 62 75 66 66  65 72 20 6f 76 65 72 66  |ack/buffer overf|
000004e0  6c 6f 77 20 68 65 78 20  64 75 6d 70 20 76 61 6c  |low hex dump val|
000004f0  75 65 20 77 69 6c 6c 20  75 73 65 20 72 65 61 64  |ue will use read|
00000500  20 62 79 74 65 73 20 6f  66 20 74 68 65 20 63 75  | bytes of the cu|
00000510  72 72 65 6e 74 20 66 69  6c 65 22 29 0a 09 66 6d  |rrent file")..fm|
00000520  74 2e 50 72 69 6e 74 6c  6e 28 22 5c 30 33 33 5b  |t.Println("\033[|
00000530  33 34 6d 5b 20 2b 20 5d  20 4c 6f 67 67 65 64 20  |34m[ + ] Logged |
00000540  4f 75 74 20 46 69 6c 65  20 7e 3e 20 6c 6f 67 2e  |Out File ~> log.|
00000550  74 78 74 22 29 0a 09 66  6d 74 2e 50 72 69 6e 74  |txt")..fmt.Print|
00000560  6c 6e 28 22 5c 30 33 33  5b 33 35 6d 22 29 0a 09  |ln("\033[35m")..|
00000570  74 69 6d 65 2e 53 6c 65  65 70 28 32 20 2a 20 74  |time.Sleep(2 * t|
00000580  69 6d 65 2e 53 65 63 6f  6e 64 29 0a 09 66 69 6c  |ime.Second)..fil|
00000590  65 2c 20 65 72 72 20 3a  3d 20 6f 73 2e 4f 70 65  |e, err := os.Ope|
000005a0  6e 28 2a 66 6c 61 67 46  69 6c 65 29 0a 09 65 28  |n(*flagFile)..e(|
000005b0  65 72 72 29 0a 09 64 65  66 65 72 20 66 69 6c 65  |err)..defer file|
000005c0  2e 43 6c 6f 73 65 28 29  0a 09 2f 2f 0a 09 2f 2f  |.Close()..//..//|
000005d0  0a 09 72 65 61 64 20 3a  3d 20 62 75 66 69 6f 2e  |..read := bufio.|
000005e0  4e 65 77 52 65 61 64 65  72 28 66 69 6c 65 29 0a  |NewReader(file).|
000005f0  09 62 75 66 20 3a 3d 20  6d 61 6b 65 28 5b 5d 62  |.buf := make([]b|
00000600  79 74 65 2c 20 72 65 29  0a 09 66 6f 72 20 7b 0a  |yte, re)..for {.|
00000610  09 09 5f 2c 20 65 72 72  20 3a 3d 20 72 65 61 64  |.._, err := read|
00000620  2e 52 65 61 64 28 62 75  66 29 0a 09 09 65 28 65  |.Read(buf)...e(e|
00000630  72 72 29 0a 09 09 62 72  65 61 6b 0a 09 7d 0a 09  |rr)...break..}..|
00000640  66 6d 74 2e 50 72 69 6e  74 66 28 22 25 73 22 2c  |fmt.Printf("%s",|
00000650  20 68 65 78 2e 44 75 6d  70 28 62 75 66 29 29 0a  | hex.Dump(buf)).|
00000660  09 63 72 2c 20 65 72 72  20 3a 3d 20 6f 73 2e 43  |.cr, err := os.C|
00000670  72 65 61 74 65 28 22 6c  6f 67 2e 74 78 74 22 29  |reate("log.txt")|
00000680  0a 09 65 28 65 72 72 29  0a 09 64 65 66 65 72 20  |..e(err)..defer |
00000690  63 72 2e 43 6c 6f 73 65  28 29 0a 09 5f 2c 20 65  |cr.Close().._, e|
000006a0  72 72 32 20 3a 3d 20 63  72 2e 57 72 69 74 65 53  |rr2 := cr.WriteS|
000006b0  74 72 69 6e 67 28 68 65  78 2e 44 75 6d 70 28 62  |tring(hex.Dump(b|
000006c0  75 66 29 29 0a 09 65 28  65 72 72 32 29 0a 7d 0a  |uf))..e(err2).}.|
000006d0  0a 2f 2f 2f 2f 2f 2f 2f  2f 2f 2f 2f 2f 2f 2f 2f  |.///////////////|
000006e0  2f 2f 2f 2f 2f 2f 2f 20  66 69 6c 69 6e 67 0a 0a  |/////// filing..|
000006f0  2f 2f 09 63 72 2c 20 65  72 72 20 3a 3d 20 6f 73  |//.cr, err := os|
00000700  2e 43 72 65 61 74 65 28  22 6c 6f 67 2e 74 78 74  |.Create("log.txt|
00000710  22 29 0a 2f 2f 09 65 28  65 72 72 29 0a 2f 2f 09  |").//.e(err).//.|
00000720  64 65 66 65 72 20 63 72  2e 43 6c 6f 73 65 28 29  |defer cr.Close()|
00000730  0a 2f 2f 09 5f 2c 20 65  72 72 32 20 3a 3d 20 63  |.//._, err2 := c|
00000740  72 2e 57 72 69 74 65 53  74 72 69 6e 67 28 68 65  |r.WriteString(he|
00000750  78 2e 44 75 6d 70 28 62  75 66 29 29 0a 2f 2f 09  |x.Dump(buf)).//.|
00000760  65 28 65 72 72 32 29 0a  2f 2f 09 66 6d 74 2e 50  |e(err2).//.fmt.P|
00000770  72 69 6e 74 66 28 22 25  73 22 2c 20 68 65 78 2e  |rintf("%s", hex.|
00000780  44 75 6d 70 28 62 75 66  29 29 0a 2f 2f 09 66 69  |Dump(buf)).//.fi|
00000790  6c 65 6e 61 6d 65 20 3a  3d 20 22 6c 6f 67 2e 74  |lename := "log.t|
000007a0  78 74 22 0a 2f 2f 09 66  6d 74 2e 50 72 69 6e 74  |xt".//.fmt.Print|
000007b0  6c 6e 28 22 5c 30 33 33  5b 33 32 6d 5b 2b 5d 20  |ln("\033[32m[+] |
000007c0  44 61 74 61 20 6c 6f 67  67 65 64 20 74 6f 20 61  |Data logged to a|
000007d0  20 66 69 6c 65 20 7e 3e  20 22 2c 20 66 69 6c 65  | file ~> ", file|
000007e0  6e 61 6d 65 29 0a                                 |name).|
